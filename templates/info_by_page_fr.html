<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="utf-8">
		<title>Rétroaction par page</title>
		<meta content="width=device-width,initial-scale=1" name="viewport">
		<meta name=”robots” content=”noindex, follow”>
		<script type="text/javascript" src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_30/cdts/compiled/soyutils.js"></script>
		<script type="text/javascript" src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_30/cdts/compiled/wet-en.js"></script>
		<link href="https://test.canada.ca/covid-19-guidance/proto/css/alpha-beta-banner.css" rel="stylesheet">
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
		<!-- Write closure template -->
		<script type="text/javascript">
			document.write(wet.builder.refTop({
			}));
		</script>
	</head>
	<body vocab="http://schema.org/" typeof="WebPage">
		<div id="def-top">
		</div>
		<script type="text/javascript">
			var defTop = document.getElementById("def-top");
			defTop.outerHTML = wet.builder.top({
				lngLinks: [{
					lang: "fr",
					href: "#",
					text: "Français"
				}],
				breadcrumbs: [{
					title: "Canada.ca",
					href: "https://www.canada.ca/fr.html"
				}],
				search: true,
				siteMenu: true,
				showPreContent: true
			});
		</script>
		<main role="main" property="mainContentOfPage" class="container">
			<h1>Données de rétroaction pour {{ title }}</h1>
			<a href='{{ url }}'>{{ url }}</a>
			<p>Changer les dates :</p>
			<form id="attributes" name="attributes" action="{{ url_for('bypage') }}" method="post">
				<input type="hidden" name="page" value={{ page }}>
				<label for="start_date">Date de début :</label>
				<input type="date" id="start_date" name="start_date" value={{ start_date }}><br>
				<label for="end_date">Date de fin :</label>
				<input type="date" id="end_date" name="end_date" value={{ end_date }}><br>
				<input class="btn btn-primary" name=submit type="submit" value="Allez">
			</form>
			<script>
				const form = window.document.getElementById("attributes");
				form.addEventListener('submit', submitRedirect);
				function submitRedirect(event) {
					event.preventDefault();
					var formData = new FormData(form);
					var queryString = "?";
					for (var key of formData.keys()) {
						queryString = queryString + key + "=" + formData.get(key) + "&";
					}
					location.href = 'bypage' + queryString;
				}
			</script>
			<h2 class='h3'>Sur cette page</h2>
			<ul>
				<li><a href="#found">Trouvé leur réponse?</a</li>
				<li><a href="#tag">Par étiquette</a></li>
				<li><a href="#reason">Par raison</a></li>
				<li><a href="#common">Mots les plus fréquents</a></li>
			</ul>
			<h2 id="found">Trouvé leur réponse?</h2>
      <div class="row">
        <div class="col-md-6">
        <h3>De {{ start_date }} à {{ end_date }} </h3>
        <ul>
          <li>Oui : <strong>{{ yes_period }}</strong></li>
  				<li>Non : <strong>{{ no_period }}</strong></li>
  				<li>Ratio : <strong>{{ score_period }}%</strong> ({{ delta }} comparé à toutes les données)</li>
        </ul>
        </div>
        <div class="col-md-6">
        <h3>Toutes les données (de {{ all_start }} à {{ all_end }})</h3>
        <ul>
          <li>Oui : <strong>{{ yes }}</strong></li>
  				<li>Non : <strong>{{ no }}</strong></li>
  				<li>Ratio : <strong>{{ score }}%</strong></li>
        </ul>
        </div>
      </div>

			<img src="data:image/png;base64, {{ plot_url }}" alt="">

			<h2 id="tag">Par étiquette (de {{ start_date }} à {{ end_date }})</h2>
			<ul class="list-unstyled">
				{% for tag, count, unique_tag in over_tags %}
				<li>
					<details>
						<summary>{{tag}} ({{count}})</summary>
						<table class="wb-tables table table-striped">
							<tr>
								{% for col in tag_columns %}
								<th>{{col}}</th>
								{% endfor %}
							</tr>
							{%for row in zip(list(over_dict[unique_tag]['Date']), list(over_dict[unique_tag]['Comment'])) %}
							<tr>
								{% for col, row_ in zip(tag_columns, row) %}
								<td>
									{{row_}}
								</td>
								{% endfor %}
							</tr>
							{% endfor %}
						</table>
					</details>
				</li>
				{% endfor %}
				</ul>

				<h3>Autres étiquettes</h3>
					<details>
						<summary>Étiquettes avec 3 commentaires ou moins</summary>
						<ul class="list-unstyled">
							{% for tag, count, unique_tag in under_tags %}
							<li>
								<details>
									<summary>{{tag}} ({{count}})</summary>
									<table class="wb-tables table table-striped">
										<tr>
											{% for col in tag_columns %}
											<th>{{col}}</th>
											{% endfor %}
										</tr>
										{%for row in zip(list(under_dict[unique_tag]['Date']), list(under_dict[unique_tag]['Comment'])) %}
										<tr>
											{% for col, row_ in zip(tag_columns, row) %}
											<td>
												{{row_}}
											</td>
											{% endfor %}
										</tr>
										{% endfor %}
									</table>
								</details>
							</li>
							{% endfor %}
						</ul>
						</details>


			<h2 id="reason">Par raison (de {{ start_date }} à {{ end_date }})</h2>
			<table class="wb-tables table table-striped">
				<tr>
					{% for col in reason_column_names %}
					<th>{{col}}</th>
					{% endfor %}
				</tr>
				{% for row in row_data_reason %}
				<tr>
					{% for col, row_ in zip(reason_column_names, row) %}
					<td>{{row_}}</td>
					{% endfor %}
				</tr>
				{% endfor %}
			</table>

			<h2 id="common">Mots les plus fréquents (de {{ start_date }} à {{ end_date }})</h2>
			<table class="wb-tables table table-striped">
				<tr>
					{% for col in word_column_names %}
					<th>{{col}}</th>
					{% endfor %}
				</tr>
				{% for row in row_data_word %}
				<tr>
					{% for col, row_ in zip(word_column_names, row) %}
					<td>{{row_}}</td>
					{% endfor %}
				</tr>
				{% endfor %}
			</table>
	</body>
</html>
